<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PG-OPPER - Digital Marketplace | ·Äí·ÄÖ·Ä∫·ÄÇ·Äª·ÄÖ·Ä∫·Äê·Äö·Ä∫ ·ÄÖ·Äª·Ä±·Ä∏·ÄÄ·ÄΩ·ÄÄ·Ä∫</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            font-family: 'Poppins', sans-serif;
        }

        .myanmar-gradient {
            background: linear-gradient(135deg, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4, #FFEAA7);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .myanmar-map {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4, #FFEAA7);
            position: relative;
            animation: mapSpin 3s ease-in-out infinite;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .myanmar-map::before {
            content: 'üá≤üá≤';
            font-size: 60px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: flagWave 2s ease-in-out infinite alternate;
        }

        @keyframes mapSpin {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }

        @keyframes flagWave {
            0% { transform: translate(-50%, -50%) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1.2); }
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .btn-primary:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .card-hover {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-hover:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .floating-animation {
            animation: float 4s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }

        .pulse-animation {
            animation: pulse 2.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        .tab-active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1.1);
        }

        .chat-bubble {
            max-width: 75%;
            word-wrap: break-word;
            animation: bubbleIn 0.3s ease-out;
        }

        @keyframes bubbleIn {
            0% { opacity: 0; transform: scale(0.8) translateY(20px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .chat-bubble.sent {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            border-radius: 20px 20px 5px 20px;
        }

        .chat-bubble.received {
            background: rgba(255,255,255,0.9);
            color: #333;
            margin-right: auto;
            border-radius: 20px 20px 20px 5px;
        }

        .loading-dots::after {
            content: '...';
            animation: dots 1.8s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { color: rgba(255,255,255,0); text-shadow: .25em 0 0 rgba(255,255,255,0), .5em 0 0 rgba(255,255,255,0); }
            40% { color: white; text-shadow: .25em 0 0 rgba(255,255,255,0), .5em 0 0 rgba(255,255,255,0); }
            60% { text-shadow: .25em 0 0 white, .5em 0 0 rgba(255,255,255,0); }
            80%, 100% { text-shadow: .25em 0 0 white, .5em 0 0 white; }
        }

        .news-card {
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
        }

        .news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .bottom-nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .nav-item.active {
            color: #667eea;
            transform: scale(1.15) translateY(-2px);
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background: #667eea;
            border-radius: 50%;
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
        }

        .file-card {
            background: rgba(255,255,255,0.9);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .file-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4, #45B7D1);
        }

        .file-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
        }

        .payment-option {
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.4s ease;
            background: rgba(255,255,255,0.1);
        }

        .payment-option:hover, .payment-option.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
            transform: scale(1.02);
        }

        .hidden {
            display: none !important;
        }

        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUp {
            0% { transform: translateY(100%); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        .modal-overlay {
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 10px 15px;
            background: rgba(255,255,255,0.9);
            border-radius: 20px;
            margin-right: auto;
            max-width: 80px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.6s ease-in-out infinite;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.3s; }
        .typing-dot:nth-child(3) { animation-delay: 0.6s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-12px); opacity: 1; }
        }

        .notification {
            animation: slideInRight 0.5s ease-out;
        }

        @keyframes slideInRight {
            0% { transform: translateX(100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }

        .success-pulse {
            animation: successPulse 0.8s ease-out;
        }

        @keyframes successPulse {
            0% { transform: scale(1); background-color: currentColor; }
            50% { transform: scale(1.1); background-color: #10b981; }
            100% { transform: scale(1); background-color: currentColor; }
        }

        .error-shake {
            animation: shake 0.6s ease-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        .icon-bounce {
            animation: iconBounce 2s ease-in-out infinite;
        }

        @keyframes iconBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .scrollbar-hidden::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hidden {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .progress-ring {
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .myanmar-pattern {
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(78, 205, 196, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 25%, rgba(69, 183, 209, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 25% 75%, rgba(255, 234, 167, 0.1) 0%, transparent 50%);
        }

        @media (max-width: 640px) {
            .file-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 15px;
            }
            
            .chat-bubble {
                max-width: 85%;
            }
            
            .myanmar-map {
                width: 100px;
                height: 100px;
            }
            
            .myanmar-map::before {
                font-size: 50px;
            }
        }

        .country-flag {
            font-size: 1.5em;
            margin-right: 8px;
        }

        .phone-input-container {
            position: relative;
        }

        .phone-input-container::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 2px;
            height: 20px;
            background: #e5e7eb;
        }

        .auth-form {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
            border-radius: 50%;
            padding: 15px;
            margin-bottom: 15px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .loading-progress {
            width: 0%;
            height: 4px;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4, #45B7D1, #FFEAA7);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .glow-effect {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .myanmar-border {
            border-image: linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1, #FFEAA7) 1;
        }
    </style>
</head>
<body class="myanmar-gradient min-h-screen myanmar-pattern">
    <!-- Loading Screen -->
    <div id="loadingScreen" class="fixed inset-0 z-50 flex items-center justify-center myanmar-gradient">
        <div class="text-center">
            <div class="myanmar-map mb-6 mx-auto"></div>
            <h2 class="text-white text-3xl font-bold mb-3 gradient-text">PG-OPPER</h2>
            <p class="text-white opacity-90 text-lg mb-6">Digital Marketplace | ·Äí·ÄÖ·Ä∫·ÄÇ·Äª·ÄÖ·Ä∫·Äê·Äö·Ä∫ ·ÄÖ·Äª·Ä±·Ä∏·ÄÄ·ÄΩ·ÄÄ·Ä∫</p>
            <div class="w-64 h-2 bg-white bg-opacity-20 rounded-full mx-auto overflow-hidden">
                <div id="loadingProgress" class="loading-progress"></div>
            </div>
            <p class="text-white opacity-80 mt-4 loading-dots">Loading</p>
        </div>
    </div>

    <!-- Authentication Screen -->
    <div id="authScreen" class="hidden fixed inset-0 z-40 flex items-center justify-center p-4">
        <div class="auth-form rounded-3xl p-8 w-full max-w-md slide-up">
            <!-- Login Form -->
            <div id="loginForm" class="fade-in">
                <div class="text-center mb-8">
                    <div class="feature-icon mx-auto mb-4">
                        <i class="fas fa-gem text-2xl text-white"></i>
                    </div>
                    <h1 class="text-4xl font-bold text-white mb-3">PG-OPPER</h1>
                    <p class="text-white opacity-90">Welcome Back | ·Äï·Äº·Äî·Ä∫·Äú·Ää·Ä∫·ÄÄ·Äº·Ä≠·ÄØ·ÄÜ·Ä≠·ÄØ·Äï·Ä´·Äû·Ää·Ä∫</p>
                    <div class="w-16 h-1 bg-gradient-to-r from-transparent via-white to-transparent mx-auto mt-4 opacity-50"></div>
                </div>
                
                <form id="loginFormElement" class="space-y-6">
                    <div>
                        <label class="block text-white text-sm font-medium mb-3">
                            <i class="fas fa-globe mr-2"></i>Country | ·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·ÄÑ·Ä∂
                        </label>
                        <select id="loginCountry" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                            <option value="+95" class="text-black">üá≤üá≤ Myanmar (+95)</option>
                            <option value="+86" class="text-black">üá®üá≥ China (+86)</option>
                            <option value="+65" class="text-black">üá∏üá¨ Singapore (+65)</option>
                            <option value="+66" class="text-black">üáπüá≠ Thailand (+66)</option>
                        </select>
                    </div>
                    
                    <div class="phone-input-container">
                        <label class="block text-white text-sm font-medium mb-3">
                            <i class="fas fa-phone mr-2"></i>Phone Number | ·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Ä´·Äê·Ä∫
                        </label>
                        <input type="tel" id="loginPhone" class="w-full p-4 pl-16 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="Enter phone number">
                    </div>
                    
                    <div>
                        <label class="block text-white text-sm font-medium mb-3">
                            <i class="fas fa-lock mr-2"></i>Password | ·ÄÖ·ÄÄ·Ä¨·Ä∏·Äù·Äæ·ÄÄ·Ä∫
                        </label>
                        <input type="password" id="loginPassword" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="Enter password">
                    </div>
                    
                    <button type="submit" class="w-full btn-primary text-white font-semibold py-4 rounded-xl text-lg">
                        <i class="fas fa-sign-in-alt mr-2"></i>Login | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äù·ÄÑ·Ä∫·Äõ·Äî·Ä∫
                    </button>
                </form>
                
                <div class="text-center mt-8">
                    <p class="text-white opacity-80 mb-3">Don't have an account? | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äô·Äõ·Äæ·Ä≠·Äò·Ä∞·Ä∏·Äú·Ä¨·Ä∏?</p>
                    <button id="showSignup" class="text-yellow-300 font-semibold text-lg hover:text-yellow-200 transition-colors">
                        <i class="fas fa-user-plus mr-2"></i>Sign Up | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äõ·Äî·Ä∫
                    </button>
                </div>
            </div>

            <!-- Signup Form -->
            <div id="signupForm" class="hidden">
                <div class="text-center mb-8">
                    <div class="feature-icon mx-auto mb-4">
                        <i class="fas fa-user-plus text-2xl text-white"></i>
                    </div>
                    <h1 class="text-4xl font-bold text-white mb-3">Create Account</h1>
                    <p class="text-white opacity-90">Join PG-OPPER | PG-OPPER ·Äû·Ä≠·ÄØ·Ä∑ ·Äù·ÄÑ·Ä∫·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä´</p>
                    <div class="w-16 h-1 bg-gradient-to-r from-transparent via-white to-transparent mx-auto mt-4 opacity-50"></div>
                </div>
                
                <form id="signupFormElement" class="space-y-6">
                    <div>
                        <label class="block text-white text-sm font-medium mb-3">
                            <i class="fas fa-user mr-2"></i>Name | ·Ä°·Äô·Ää·Ä∫
                        </label>
                        <input type="text" id="signupName" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="Enter your name" required>
                    </div>
                    
                    <div>
                        <label class="block text-white text-sm font-medium mb-3">
                            <i class="fas fa-globe mr-2"></i>Country | ·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·ÄÑ·Ä∂
                        </label>
                        <select id="signupCountry" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                            <option value="+95" class="text-black">üá≤üá≤ Myanmar (+95)</option>
                            <option value="+86" class="text-black">üá®üá≥ China (+86)</option>
                            <option value="+65" class="text-black">üá∏üá¨ Singapore (+65)</option>
                            <option value="+66" class="text-black">üáπüá≠ Thailand (+66)</option>
                        </select>
                    </div>
                    
                    <div class="phone-input-container">
                        <label class="block text-white text-sm font-medium mb-3">
                            <i class="fas fa-phone mr-2"></i>Phone Number | ·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Ä´·Äê·Ä∫
                        </label>
                        <input type="tel" id="signupPhone" class="w-full p-4 pl-16 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="Enter phone number" required>
                    </div>
                    
                    <div>
                        <label class="block text-white text-sm font-medium mb-3">
                            <i class="fas fa-lock mr-2"></i>Password | ·ÄÖ·ÄÄ·Ä¨·Ä∏·Äù·Äæ·ÄÄ·Ä∫
                        </label>
                        <input type="password" id="signupPassword" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="Create password" required>
                    </div>
                    
                    <button type="submit" class="w-full btn-primary text-white font-semibold py-4 rounded-xl text-lg">
                        <i class="fas fa-rocket mr-2"></i>Create Account | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·Äî·Ä∫·Äê·ÄÆ·Ä∏·Äõ·Äî·Ä∫
                    </button>
                </form>
                
                <div class="text-center mt-8">
                    <p class="text-white opacity-80 mb-3">Already have an account? | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äõ·Äæ·Ä≠·Äï·Äº·ÄÆ·Ä∏·Äú·Ä¨·Ä∏?</p>
                    <button id="showLogin" class="text-yellow-300 font-semibold text-lg hover:text-yellow-200 transition-colors">
                        <i class="fas fa-sign-in-alt mr-2"></i>Login | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äù·ÄÑ·Ä∫·Äõ·Äî·Ä∫
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden min-h-screen pb-24">
        <!-- Header -->
        <header class="glass-effect text-white p-6 sticky top-0 z-30">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-r from-yellow-400 to-red-500 flex items-center justify-center">
                        <i class="fas fa-gem text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">PG-OPPER</h1>
                        <p class="text-xs opacity-75">Digital Marketplace</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="searchBtn" class="p-3 rounded-full hover:bg-white hover:bg-opacity-20 transition-all duration-300 glow-effect">
                        <i class="fas fa-search text-lg icon-bounce"></i>
                    </button>
                    <button id="notificationBtn" class="relative p-3 rounded-full hover:bg-white hover:bg-opacity-20 transition-all duration-300">
                        <i class="fas fa-bell text-lg"></i>
                        <span id="notificationBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center pulse-animation">0</span>
                    </button>
                    <button id="profileBtn" class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center floating-animation">
                        <i class="fas fa-user text-lg"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Content Pages -->
        <div class="container mx-auto px-4 py-6">
            <!-- Home Page -->
            <div id="homePage" class="page fade-in">
                <div class="mb-8">
                    <h2 class="text-white text-3xl font-bold mb-3">Digital Store</h2>
                    <h3 class="text-white text-xl opacity-90 mb-2">·Äí·ÄÖ·Ä∫·ÄÇ·Äª·ÄÖ·Ä∫·Äê·Äö·Ä∫ ·ÄÜ·Ä≠·ÄØ·ÄÑ·Ä∫</h3>
                    <p class="text-white opacity-80">Download files and apps | ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Äª·Ä¨·Ä∏·Äî·Äæ·ÄÑ·Ä∑·Ä∫ ·Ä°·ÄÄ·Ä∫·Äï·Ä∫·Äô·Äª·Ä¨·Ä∏ ·Äí·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·Äú·ÄØ·Äí·Ä∫·Äú·ÄØ·Äï·Ä∫·Äï·Ä´</p>
                    <div class="w-20 h-1 bg-gradient-to-r from-yellow-400 to-red-500 rounded-full mt-4"></div>
                </div>

                <!-- Search Bar -->
                <div class="glass-effect rounded-2xl p-4 mb-6">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-search text-white opacity-70"></i>
                        <input type="text" id="fileSearchInput" placeholder="Search files and apps... | ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Äª·Ä¨·Ä∏·Äî·Äæ·ÄÑ·Ä∑·Ä∫ ·Ä°·ÄÄ·Ä∫·Äï·Ä∫·Äô·Äª·Ä¨·Ä∏ ·Äõ·Äæ·Ä¨·Äñ·ÄΩ·Ä±·Äï·Ä´..." class="flex-1 bg-transparent text-white placeholder-white placeholder-opacity-70 focus:outline-none">
                        <button id="filterBtn" class="text-white opacity-70 hover:opacity-100 transition-opacity">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                </div>

                <div id="fileGrid" class="file-grid mb-8">
                    <!-- Files will be loaded here -->
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="text-center py-16">
                    <div class="feature-icon mx-auto mb-6">
                        <i class="fas fa-download text-4xl text-white opacity-70"></i>
                    </div>
                    <h3 class="text-white text-2xl font-semibold mb-3">No Files Available</h3>
                    <p class="text-white opacity-70 mb-2">·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Äª·Ä¨·Ä∏ ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´</p>
                    <p class="text-white opacity-60">Files will appear here when uploaded by admin</p>
                </div>
            </div>

            <!-- Chat Page -->
            <div id="chatPage" class="page hidden">
                <div class="mb-8">
                    <h2 class="text-white text-3xl font-bold mb-3">Messages</h2>
                    <h3 class="text-white text-xl opacity-90 mb-2">·ÄÖ·Ä¨·Äô·Äª·Ä¨·Ä∏</h3>
                    <p class="text-white opacity-80">Chat with other users | ·Ä°·ÄÅ·Äº·Ä¨·Ä∏·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äû·Ä∞·Äô·Äª·Ä¨·Ä∏·Äî·Äæ·ÄÑ·Ä∑·Ä∫ ·ÄÖ·ÄÄ·Ä¨·Ä∏·Äï·Äº·Ä±·Ä¨·Äõ·Äî·Ä∫</p>
                    <div class="w-20 h-1 bg-gradient-to-r from-green-400 to-blue-500 rounded-full mt-4"></div>
                </div>

                <!-- Search Users -->
                <div class="glass-effect rounded-2xl p-4 mb-6">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-user-search text-white opacity-70"></i>
                        <input type="text" id="userSearchInput" placeholder="Search users by username... | ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äû·Ä∞·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Äõ·Äæ·Ä¨·Äñ·ÄΩ·Ä±·Äï·Ä´..." class="flex-1 bg-transparent text-white placeholder-white placeholder-opacity-70 focus:outline-none">
                        <button id="searchUsersBtn" class="btn-primary px-4 py-2 rounded-lg text-sm">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>

                <!-- Chat List -->
                <div id="chatList" class="space-y-4">
                    <!-- Chat items will be loaded here -->
                </div>

                <!-- Empty Chat State -->
                <div id="emptyChatState" class="text-center py-16">
                    <div class="feature-icon mx-auto mb-6">
                        <i class="fas fa-comments text-4xl text-white opacity-70"></i>
                    </div>
                    <h3 class="text-white text-2xl font-semibold mb-3">No Conversations</h3>
                    <p class="text-white opacity-70 mb-2">·ÄÖ·ÄÄ·Ä¨·Ä∏·Äï·Äº·Ä±·Ä¨·ÄÜ·Ä≠·ÄØ·Äô·Äæ·ÄØ ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´</p>
                    <p class="text-white opacity-60">Start chatting with other users</p>
                </div>
            </div>

            <!-- News Page -->
            <div id="newsPage" class="page hidden">
                <div class="mb-8 flex items-center justify-between">
                    <div>
                        <h2 class="text-white text-3xl font-bold mb-3">News Feed</h2>
                        <h3 class="text-white text-xl opacity-90 mb-2">·Äû·Äê·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏</h3>
                        <p class="text-white opacity-80">Latest updates and posts | ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏·Äï·Ä±·Ä´·Ä∫ ·Äû·Äê·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏</p>
                        <div class="w-20 h-1 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full mt-4"></div>
                    </div>
                    <button id="createNewsBtn" class="btn-primary text-white px-6 py-3 rounded-xl">
                        <i class="fas fa-plus mr-2"></i>Post
                    </button>
                </div>

                <div id="newsFeed" class="space-y-6">
                    <!-- News items will be loaded here -->
                </div>

                <!-- Empty News State -->
                <div id="emptyNewsState" class="text-center py-16">
                    <div class="feature-icon mx-auto mb-6">
                        <i class="fas fa-newspaper text-4xl text-white opacity-70"></i>
                    </div>
                    <h3 class="text-white text-2xl font-semibold mb-3">No News Yet</h3>
                    <p class="text-white opacity-70 mb-2">·Äû·Äê·ÄÑ·Ä∫·Ä∏ ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´</p>
                    <p class="text-white opacity-60">Be the first to share something!</p>
                </div>
            </div>

            <!-- Support Page -->
            <div id="supportPage" class="page hidden">
                <div class="mb-8">
                    <h2 class="text-white text-3xl font-bold mb-3">Support</h2>
                    <h3 class="text-white text-xl opacity-90 mb-2">·Ä°·ÄÄ·Ä∞·Ä°·Ää·ÄÆ</h3>
                    <p class="text-white opacity-80">Get help from admin | ·Ä°·ÄÄ·Ä∫·Äí·Äô·ÄÑ·Ä∫·Äë·Ä∂·Äô·Äæ ·Ä°·ÄÄ·Ä∞·Ä°·Ää·ÄÆ·Äö·Ä∞·Äï·Ä´</p>
                    <div class="w-20 h-1 bg-gradient-to-r from-orange-400 to-red-500 rounded-full mt-4"></div>
                </div>

                <!-- Support Chat Container -->
                <div class="glass-effect rounded-2xl p-4 mb-6" style="height: 400px;">
                    <div id="supportMessages" class="h-full overflow-y-auto scrollbar-hidden space-y-4 p-2">
                        <!-- Welcome Message -->
                        <div class="chat-bubble received p-4">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center">
                                    <i class="fas fa-headset text-white text-sm"></i>
                                </div>
                                <span class="font-semibold text-gray-700">Admin Support</span>
                            </div>
                            <p class="text-gray-700 mb-1">Hello! How can I help you today?</p>
                            <p class="text-gray-700">·Äô·ÄÑ·Ä∫·Äπ·ÄÇ·Äú·Ä¨·Äï·Ä´! ·Äò·Äö·Ä∫·Äú·Ä≠·ÄØ ·Ä°·ÄÄ·Ä∞·Ä°·Ää·ÄÆ·Äï·Ä±·Ä∏·Äõ·Äô·Äú·Ä≤?</p>
                        </div>
                    </div>
                </div>

                <!-- Support Message Input -->
                <div class="glass-effect rounded-2xl p-4">
                    <div class="flex space-x-3">
                        <button id="attachFileBtn" class="text-white opacity-70 hover:opacity-100 transition-opacity p-3">
                            <i class="fas fa-paperclip text-lg"></i>
                        </button>
                        <input type="text" id="supportMessageInput" class="flex-1 p-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-70 focus:outline-none focus:ring-2 focus:ring-blue-500 border-2 border-white border-opacity-20" placeholder="Type your message... | ·ÄÖ·Ä¨·Äê·Ä≠·ÄØ·Ä∑·Äï·Ä´...">
                        <button id="sendSupportMessage" class="btn-primary px-6 py-3 rounded-xl">
                            <i class="fas fa-paper-plane text-lg"></i>
                        </button>
                    </div>
                    <input type="file" id="supportFileInput" class="hidden" accept="image/*,audio/*,video/*,.pdf,.doc,.docx">
                </div>
            </div>

            <!-- About Page -->
            <div id="aboutPage" class="page hidden">
                <div class="mb-8">
                    <h2 class="text-white text-3xl font-bold mb-3">About Us</h2>
                    <h3 class="text-white text-xl opacity-90 mb-2">·ÄÄ·Äª·ÄΩ·Äî·Ä∫·ÄØ·Äï·Ä∫·Äê·Ä≠·ÄØ·Ä∑·Ä°·ÄÄ·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏</h3>
                    <p class="text-white opacity-80">Learn more about PG-OPPER</p>
                    <div class="w-20 h-1 bg-gradient-to-r from-indigo-400 to-purple-500 rounded-full mt-4"></div>
                </div>

                <div id="aboutContent" class="space-y-6">
                    <!-- About content will be loaded here -->
                </div>

                <!-- Default About Content -->
                <div id="defaultAbout" class="glass-effect rounded-2xl p-8">
                    <div class="text-center mb-8">
                        <div class="feature-icon mx-auto mb-4">
                            <i class="fas fa-gem text-3xl text-white"></i>
                        </div>
                        <h3 class="text-white text-2xl font-bold mb-4">PG-OPPER Digital Marketplace</h3>
                    </div>
                    
                    <div class="space-y-6 text-white">
                        <p class="opacity-90 leading-relaxed">
                            PG-OPPER is your premier digital marketplace for files, applications, and digital content. 
                            We provide a secure platform for users to discover, purchase, and download digital products.
                        </p>
                        
                        <p class="opacity-90 leading-relaxed">
                            ·ÄÄ·Äª·ÄΩ·Äî·Ä∫·ÄØ·Äï·Ä∫·Äê·Ä≠·ÄØ·Ä∑·Äû·Ää·Ä∫ ·Äí·ÄÖ·Ä∫·ÄÇ·Äª·ÄÖ·Ä∫·Äê·Äö·Ä∫·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Äª·Ä¨·Ä∏·Åä ·Ä°·ÄÄ·Ä∫·Äï·Ä∫·Äú·ÄÆ·ÄÄ·Ä±·Ä∏·Äõ·Äæ·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏·Äî·Äæ·ÄÑ·Ä∑·Ä∫ ·Äí·ÄÖ·Ä∫·ÄÇ·Äª·ÄÖ·Ä∫·Äê·Äö·Ä∫·Ä°·ÄÄ·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·Ä°·Äõ·Ä¨·Äô·Äª·Ä¨·Ä∏·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ 
                            ·Äë·Ä≠·Äï·Ä∫·Äê·Äî·Ä∫·Ä∏·ÄÖ·Äª·Ä±·Ä∏·ÄÄ·ÄΩ·ÄÄ·Ä∫·Äñ·Äº·ÄÖ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã ·Äú·ÄØ·Ä∂·ÄÅ·Äº·ÄØ·Ä∂·Äï·Äº·ÄÆ·Ä∏ ·Ä°·Äõ·Ää·Ä∫·Ä°·Äû·ÄΩ·Ä±·Ä∏·Äô·Äº·ÄÑ·Ä∑·Ä∫ ·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ·ÄÄ·Ä≠·ÄØ ·Äï·Ä±·Ä∏·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã
                        </p>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                            <div class="bg-white bg-opacity-10 rounded-xl p-6">
                                <i class="fas fa-shield-alt text-2xl text-green-400 mb-3"></i>
                                <h4 class="font-semibold mb-2">Secure Platform</h4>
                                <p class="opacity-80 text-sm">·Äú·ÄØ·Ä∂·ÄÅ·Äº·ÄØ·Ä∂·Äû·Ä±·Ä¨ ·Äï·Äú·Äï·Ä∫·Äñ·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏</p>
                            </div>
                            <div class="bg-white bg-opacity-10 rounded-xl p-6">
                                <i class="fas fa-clock text-2xl text-blue-400 mb-3"></i>
                                <h4 class="font-semibold mb-2">24/7 Support</h4>
                                <p class="opacity-80 text-sm">·ÅÇ·ÅÑ ·Äî·Ä¨·Äõ·ÄÆ ·Ä°·ÄÄ·Ä∞·Ä°·Ää·ÄÆ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mi (Profile) Page -->
            <div id="miPage" class="page hidden">
                <div class="mb-8">
                    <h2 class="text-white text-3xl font-bold mb-3">My Profile</h2>
                    <h3 class="text-white text-xl opacity-90 mb-2">·ÄÄ·Äª·ÄΩ·Äî·Ä∫·ÄØ·Äï·Ä∫·Åè·Äï·Äõ·Ä≠·ÄØ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫</h3>
                    <p class="text-white opacity-80">Manage your account | ·Äû·ÄÑ·Ä∑·Ä∫·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·ÄÄ·Ä≠·ÄØ ·ÄÖ·ÄÆ·Äô·Ä∂·Äï·Ä´</p>
                    <div class="w-20 h-1 bg-gradient-to-r from-pink-400 to-red-500 rounded-full mt-4"></div>
                </div>

                <!-- Profile Card -->
                <div class="glass-effect rounded-2xl p-8 mb-6">
                    <div class="flex items-center space-x-6 mb-6">
                        <div class="w-20 h-20 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center floating-animation">
                            <i class="fas fa-user text-3xl text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-white text-2xl font-bold" id="profileName">User</h3>
                            <p class="text-white opacity-70 text-lg" id="profilePhone">+95xxxxxxxxx</p>
                            <p class="text-white opacity-60 text-sm" id="profileCountry">Myanmar</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-4 text-center">
                        <div class="bg-white bg-opacity-20 rounded-xl p-6">
                            <h4 class="text-white text-3xl font-bold pulse-animation" id="purchaseCount">0</h4>
                            <p class="text-white opacity-70 mt-2">Purchases</p>
                            <p class="text-white opacity-60 text-sm">·Äù·Äö·Ä∫·Äö·Ä∞·Äô·Äæ·ÄØ·Äô·Äª·Ä¨·Ä∏</p>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-6">
                            <h4 class="text-white text-3xl font-bold pulse-animation" id="newsCount">0</h4>
                            <p class="text-white opacity-70 mt-2">News Posts</p>
                            <p class="text-white opacity-60 text-sm">·Äû·Äê·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏</p>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-6">
                            <h4 class="text-white text-3xl font-bold pulse-animation" id="chatCount">0</h4>
                            <p class="text-white opacity-70 mt-2">Chats</p>
                            <p class="text-white opacity-60 text-sm">·ÄÖ·ÄÄ·Ä¨·Ä∏·Äï·Äº·Ä±·Ä¨·Äô·Äæ·ÄØ·Äô·Äª·Ä¨·Ä∏</p>
                        </div>
                    </div>
                </div>

                <!-- Purchase History -->
                <div class="glass-effect rounded-2xl p-6 mb-6">
                    <h3 class="text-white text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-history mr-3"></i>Purchase History | ·Äù·Äö·Ä∫·Äö·Ä∞·Äô·Äæ·ÄØ·Äô·Äæ·Äê·Ä∫·Äê·Äô·Ä∫·Ä∏
                    </h3>
                    <div id="purchaseHistory" class="space-y-4">
                        <!-- Purchase history will be loaded here -->
                    </div>
                </div>

                <!-- Actions -->
                <div class="space-y-4">
                    <button id="createNewsProfileBtn" class="w-full glass-effect text-white p-6 rounded-2xl text-left hover:bg-white hover:bg-opacity-10 transition-all card-hover">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-newspaper text-2xl mr-4"></i>
                                <div>
                                    <h4 class="font-semibold text-lg">Create News Profile</h4>
                                    <p class="opacity-70 text-sm">·Äû·Äê·ÄÑ·Ä∫·Ä∏·Äï·Äõ·Ä≠·ÄØ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·Äñ·Äî·Ä∫·Äê·ÄÆ·Ä∏·Äõ·Äî·Ä∫</p>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-xl opacity-50"></i>
                        </div>
                    </button>
                    
                    <button id="settingsBtn" class="w-full glass-effect text-white p-6 rounded-2xl text-left hover:bg-white hover:bg-opacity-10 transition-all card-hover">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-cog text-2xl mr-4"></i>
                                <div>
                                    <h4 class="font-semibold text-lg">Settings</h4>
                                    <p class="opacity-70 text-sm">·ÄÜ·ÄÄ·Ä∫·Äê·ÄÑ·Ä∫·Äô·Äª·Ä¨·Ä∏</p>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-xl opacity-50"></i>
                        </div>
                    </button>
                    
                    <button id="logoutBtn" class="w-full bg-red-500 bg-opacity-80 hover:bg-opacity-100 text-white p-6 rounded-2xl text-left transition-all card-hover">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-sign-out-alt text-2xl mr-4"></i>
                                <div>
                                    <h4 class="font-semibold text-lg">Logout</h4>
                                    <p class="opacity-70 text-sm">·Äë·ÄΩ·ÄÄ·Ä∫·Äõ·Äî·Ä∫</p>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-xl opacity-50"></i>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav fixed bottom-0 left-0 right-0 p-4 z-20">
            <div class="flex justify-around">
                <button class="nav-item active flex flex-col items-center space-y-2" data-page="home">
                    <i class="fas fa-home text-2xl"></i>
                    <span class="text-xs font-semibold">Home</span>
                </button>
                <button class="nav-item flex flex-col items-center space-y-2" data-page="chat">
                    <i class="fas fa-comments text-2xl"></i>
                    <span class="text-xs font-semibold">Chat</span>
                </button>
                <button class="nav-item flex flex-col items-center space-y-2" data-page="news">
                    <i class="fas fa-newspaper text-2xl"></i>
                    <span class="text-xs font-semibold">News</span>
                </button>
                <button class="nav-item flex flex-col items-center space-y-2" data-page="support">
                    <i class="fas fa-headset text-2xl"></i>
                    <span class="text-xs font-semibold">Support</span>
                </button>
                <button class="nav-item flex flex-col items-center space-y-2" data-page="about">
                    <i class="fas fa-info-circle text-2xl"></i>
                    <span class="text-xs font-semibold">About</span>
                </button>
                <button class="nav-item flex flex-col items-center space-y-2" data-page="mi">
                    <i class="fas fa-user text-2xl"></i>
                    <span class="text-xs font-semibold">Mi</span>
                </button>
            </div>
        </nav>
    </div>

    <!-- Purchase Modal -->
    <div id="purchaseModal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay">
        <div class="glass-effect rounded-3xl p-8 w-full max-w-md mx-4 slide-up">
            <div class="text-center mb-8">
                <div class="feature-icon mx-auto mb-4">
                    <i class="fas fa-shopping-cart text-2xl text-white"></i>
                </div>
                <h3 class="text-white text-2xl font-bold mb-3">Purchase File</h3>
                <p class="text-white opacity-80">Complete your purchase | ·Äû·ÄÑ·Ä∑·Ä∫·Äù·Äö·Ä∫·Äö·Ä∞·Äô·Äæ·ÄØ·ÄÄ·Ä≠·ÄØ ·Äï·Äº·ÄÆ·Ä∏·ÄÖ·ÄÆ·Ä∏·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äú·ÄØ·Äï·Ä∫·Äï·Ä´</p>
            </div>

            <div id="purchaseContent" class="space-y-6">
                <!-- Purchase content will be loaded here -->
            </div>

            <div class="flex space-x-4 mt-8">
                <button id="cancelPurchase" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-4 rounded-xl font-semibold transition-all">
                    <i class="fas fa-times mr-2"></i>Cancel
                </button>
                <button id="confirmPurchase" class="flex-1 btn-primary text-white py-4 rounded-xl font-semibold">
                    <i class="fas fa-credit-card mr-2"></i>Purchase
                </button>
            </div>
        </div>
    </div>

    <!-- Payment Proof Modal -->
    <div id="paymentProofModal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay">
        <div class="glass-effect rounded-3xl p-8 w-full max-w-md mx-4 slide-up">
            <div class="text-center mb-8">
                <div class="feature-icon mx-auto mb-4">
                    <i class="fas fa-receipt text-2xl text-white"></i>
                </div>
                <h3 class="text-white text-2xl font-bold mb-3">Upload Payment Proof</h3>
                <p class="text-white opacity-80">Upload payment screenshot | ·ÄÑ·ÄΩ·Ä±·Äï·Ä±·Ä∏·ÄÅ·Äª·Ä±·Äô·Äæ·ÄØ ·Äï·ÄØ·Ä∂·Äõ·Ä≠·Äï·Ä∫·Äê·ÄÑ·Ä∫·Äï·Ä´</p>
            </div>

            <form id="paymentProofForm" class="space-y-6">
                <div>
                    <label class="block text-white text-sm font-medium mb-3">Payment Screenshot</label>
                    <input type="file" id="paymentProofFile" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white" accept="image/*" required>
                </div>
                
                <div>
                    <label class="block text-white text-sm font-medium mb-3">Transaction ID (Optional)</label>
                    <input type="text" id="transactionId" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70" placeholder="Enter transaction ID">
                </div>

                <div class="flex space-x-4 mt-8">
                    <button type="button" id="cancelPaymentProof" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-4 rounded-xl font-semibold transition-all">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-4 rounded-xl font-semibold">
                        <i class="fas fa-upload mr-2"></i>Submit
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- News Profile Modal -->
    <div id="newsProfileModal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay">
        <div class="glass-effect rounded-3xl p-8 w-full max-w-md mx-4 slide-up">
            <div class="text-center mb-8">
                <div class="feature-icon mx-auto mb-4">
                    <i class="fas fa-user-edit text-2xl text-white"></i>
                </div>
                <h3 class="text-white text-2xl font-bold mb-3">Create News Profile</h3>
                <p class="text-white opacity-80">Set up your news profile | ·Äû·ÄÑ·Ä∑·Ä∫·Äû·Äê·ÄÑ·Ä∫·Ä∏·Äï·Äõ·Ä≠·ÄØ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫·ÄÄ·Ä≠·ÄØ ·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·Äï·Ä´</p>
            </div>

            <form id="newsProfileForm" class="space-y-6">
                <div>
                    <label class="block text-white text-sm font-medium mb-3">Username</label>
                    <input type="text" id="newsUsername" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70" placeholder="Enter unique username" required>
                    <p class="text-white opacity-60 text-xs mt-2">This will be your unique identifier</p>
                </div>
                
                <div>
                    <label class="block text-white text-sm font-medium mb-3">Display Name</label>
                    <input type="text" id="newsDisplayName" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70" placeholder="Enter display name" required>
                </div>
                
                <div>
                    <label class="block text-white text-sm font-medium mb-3">Profile Picture</label>
                    <input type="file" id="newsProfilePicture" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white" accept="image/*,.gif">
                    <p class="text-white opacity-60 text-xs mt-2">Supports images and GIFs</p>
                </div>

                <div class="flex space-x-4 mt-8">
                    <button type="button" id="cancelNewsProfile" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-4 rounded-xl font-semibold transition-all">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-4 rounded-xl font-semibold">
                        <i class="fas fa-check mr-2"></i>Create
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create News Modal -->
    <div id="createNewsModal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay">
        <div class="glass-effect rounded-3xl p-8 w-full max-w-lg mx-4 slide-up max-h-90vh overflow-y-auto scrollbar-hidden">
            <div class="text-center mb-8">
                <div class="feature-icon mx-auto mb-4">
                    <i class="fas fa-newspaper text-2xl text-white"></i>
                </div>
                <h3 class="text-white text-2xl font-bold mb-3">Create News Post</h3>
                <p class="text-white opacity-80">Share something with the community</p>
            </div>

            <form id="createNewsForm" class="space-y-6">
                <div>
                    <label class="block text-white text-sm font-medium mb-3">Title</label>
                    <input type="text" id="newsTitle" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70" placeholder="Enter news title" required>
                </div>
                
                <div>
                    <label class="block text-white text-sm font-medium mb-3">Content</label>
                    <textarea id="newsContent" rows="4" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70 resize-none" placeholder="Write your news content..." required></textarea>
                </div>

                <div>
                    <label class="block text-white text-sm font-medium mb-3">Tag Users (Optional)</label>
                    <input type="text" id="tagUsers" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white placeholder-white placeholder-opacity-70" placeholder="@username1 @username2">
                    <p class="text-white opacity-60 text-xs mt-2">Tag users by typing @username</p>
                </div>
                
                <div>
                    <label class="block text-white text-sm font-medium mb-3">Media Files (Optional)</label>
                    <input type="file" id="newsMedia" class="w-full p-4 rounded-xl border-2 border-white border-opacity-20 bg-white bg-opacity-10 text-white" multiple accept="image/*,video/*,audio/*,.gif">
                    <p class="text-white opacity-60 text-xs mt-2">Support images, videos, audio files and GIFs</p>
                </div>

                <div class="flex space-x-4 mt-8">
                    <button type="button" id="cancelCreateNews" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-4 rounded-xl font-semibold transition-all">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-4 rounded-xl font-semibold">
                        <i class="fas fa-paper-plane mr-2"></i>Post
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chat Modal -->
    <div id="chatModal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay">
        <div class="glass-effect rounded-3xl w-full max-w-md mx-4 slide-up flex flex-col" style="height: 600px;">
            <!-- Chat Header -->
            <div class="p-6 border-b border-white border-opacity-20">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div id="chatUserAvatar" class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center">
                            <i class="fas fa-user text-white"></i>
                        </div>
                        <div>
                            <h3 id="chatUserName" class="text-white font-semibold text-lg">User</h3>
                            <p id="chatUserStatus" class="text-white opacity-70 text-sm">Online</p>
                        </div>
                    </div>
                    <button id="closeChatModal" class="text-white opacity-70 hover:opacity-100 transition-opacity">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>

            <!-- Chat Messages -->
            <div id="chatMessages" class="flex-1 overflow-y-auto scrollbar-hidden p-4 space-y-4">
                <!-- Chat messages will appear here -->
            </div>

            <!-- Chat Input -->
            <div class="p-4 border-t border-white border-opacity-20">
                <div class="flex space-x-3">
                    <input type="text" id="chatMessageInput" class="flex-1 p-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-70 focus:outline-none focus:ring-2 focus:ring-blue-500 border-2 border-white border-opacity-20" placeholder="Type a message...">
                    <button id="sendChatMessage" class="btn-primary px-4 py-3 rounded-xl">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="hidden fixed top-4 right-4 z-60 notification">
        <div class="glass-effect rounded-xl p-4 text-white max-w-sm">
            <div class="flex items-center space-x-3">
                <i id="toastIcon" class="fas fa-info-circle text-xl"></i>
                <div>
                    <h4 id="toastTitle" class="font-semibold">Notification</h4>
                    <p id="toastMessage" class="text-sm opacity-90">Message content</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://rmeudvhvqlddqqkiziyo.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJtZXVkdmh2cWxkZHFxa2l6aXlvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM5OTMxOTIsImV4cCI6MjA2OTU2OTE5Mn0.xFgMv-K5o5yyTpe4U2YJK5jC9GPJp98G4cgD9p5W4ak';
        
        let supabase;
        
        // Initialize Supabase
        try {
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            console.log('Supabase initialized successfully');
        } catch (error) {
            console.error('Supabase initialization error:', error);
            showNotification('Database connection failed', 'error');
        }

        // Global State
        let currentUser = null;
        let currentPage = 'home';
        let files = [];
        let news = [];
        let chatList = [];
        let currentChatUser = null;
        let newsProfile = null;

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            // Start loading animation
            animateLoading();
            
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
                document.getElementById('authScreen').classList.remove('hidden');
            }, 4000);

            initializeEventListeners();
            checkAuthStatus();
        });

        // Loading Animation
        function animateLoading() {
            const progressBar = document.getElementById('loadingProgress');
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                }
                progressBar.style.width = progress + '%';
            }, 200);
        }

        // Check Authentication Status
        async function checkAuthStatus() {
            if (!supabase) return;
            
            try {
                const { data: { user } } = await supabase.auth.getUser();
                if (user) {
                    currentUser = user;
                    await loadUserData();
                    showMainApp();
                }
            } catch (error) {
                console.error('Auth check error:', error);
            }
        }

        // Initialize Event Listeners
        function initializeEventListeners() {
            // Auth Forms
            document.getElementById('showSignup').addEventListener('click', showSignupForm);
            document.getElementById('showLogin').addEventListener('click', showLoginForm);
            document.getElementById('loginFormElement').addEventListener('submit', handleLogin);
            document.getElementById('signupFormElement').addEventListener('submit', handleSignup);

            // Bottom Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    const page = e.currentTarget.dataset.page;
                    switchPage(page);
                });
            });

            // Modals
            document.getElementById('cancelPurchase').addEventListener('click', closePurchaseModal);
            document.getElementById('confirmPurchase').addEventListener('click', handlePurchaseConfirm);
            
            document.getElementById('createNewsProfileBtn').addEventListener('click', showNewsProfileModal);
            document.getElementById('cancelNewsProfile').addEventListener('click', closeNewsProfileModal);
            document.getElementById('newsProfileForm').addEventListener('submit', handleCreateNewsProfile);
            
            document.getElementById('createNewsBtn').addEventListener('click', showCreateNewsModal);
            document.getElementById('cancelCreateNews').addEventListener('click', closeCreateNewsModal);
            document.getElementById('createNewsForm').addEventListener('submit', handleCreateNews);

            document.getElementById('closeChatModal').addEventListener('click', closeChatModal);
            document.getElementById('sendChatMessage').addEventListener('click', sendChatMessage);
            document.getElementById('chatMessageInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendChatMessage();
            });

            // Support Chat
            document.getElementById('sendSupportMessage').addEventListener('click', sendSupportMessage);
            document.getElementById('supportMessageInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendSupportMessage();
            });
            document.getElementById('attachFileBtn').addEventListener('click', () => {
                document.getElementById('supportFileInput').click();
            });
            document.getElementById('supportFileInput').addEventListener('change', handleSupportFileUpload);

            // Payment Proof
            document.getElementById('cancelPaymentProof').addEventListener('click', closePaymentProofModal);
            document.getElementById('paymentProofForm').addEventListener('submit', handlePaymentProofSubmit);

            // Search
            document.getElementById('fileSearchInput').addEventListener('input', handleFileSearch);
            document.getElementById('userSearchInput').addEventListener('input', handleUserSearch);
            document.getElementById('searchUsersBtn').addEventListener('click', searchUsers);

            // Logout
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
        }

        // Authentication Functions
        function showSignupForm() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
        }

        function showLoginForm() {
            document.getElementById('signupForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
        }

        async function handleSignup(e) {
            e.preventDefault();
            
            if (!supabase) {
                showNotification('Database connection failed', 'error');
                return;
            }
            
            const name = document.getElementById('signupName').value.trim();
            const country = document.getElementById('signupCountry').value;
            const phone = document.getElementById('signupPhone').value.trim();
            const password = document.getElementById('signupPassword').value;
            
            if (!name || !phone || !password) {
                showNotification('Please fill all fields | ·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Ä°·ÄÄ·ÄΩ·ÄÄ·Ä∫·Äô·Äª·Ä¨·Ä∏·Ä°·Ä¨·Ä∏·Äú·ÄØ·Ä∂·Ä∏·ÄÄ·Ä≠·ÄØ ·Äñ·Äº·Ää·Ä∑·Ä∫·Äï·Ä´', 'error');
                return;
            }
            
            const fullPhone = country + phone;

            try {
                // Check if phone already exists
                const { data: existingUser } = await supabase
                    .from('users')
                    .select('*')
                    .eq('phone', fullPhone)
                    .single();

                if (existingUser) {
                    showNotification('Phone number already registered! | ·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Ä´·Äê·Ä∫·Äû·Ää·Ä∫ ·Äô·Äæ·Äê·Ä∫·Äï·ÄØ·Ä∂·Äê·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äû·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫!', 'error');
                    return;
                }

                // Create user account
                const { data, error } = await supabase.auth.signUp({
                    email: `${fullPhone.replace('+', '')}@pgopper.com`,
                    password: password,
                });

                if (error) throw error;

                // Insert user data
                const { error: insertError } = await supabase
                    .from('users')
                    .insert([
                        {
                            id: data.user.id,
                            name: name,
                            phone: fullPhone,
                            country: country,
                            password: password, // Store as text as requested
                            status: 'active',
                            created_at: new Date().toISOString()
                        }
                    ]);

                if (insertError) throw insertError;

                showNotification('Account created successfully! Please login. | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·Äî·Ä∫·Äê·ÄÆ·Ä∏·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ! ·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äù·ÄÑ·Ä∫·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä´·Åã', 'success');
                showLoginForm();
                
                // Clear form
                document.getElementById('signupFormElement').reset();
            } catch (error) {
                console.error('Signup error:', error);
                showNotification('Error creating account: ' + error.message, 'error');
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            
            if (!supabase) {
                showNotification('Database connection failed', 'error');
                return;
            }
            
            const country = document.getElementById('loginCountry').value;
            const phone = document.getElementById('loginPhone').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            if (!phone || !password) {
                showNotification('Please fill all fields | ·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Ä°·ÄÄ·ÄΩ·ÄÄ·Ä∫·Äô·Äª·Ä¨·Ä∏·Ä°·Ä¨·Ä∏·Äú·ÄØ·Ä∂·Ä∏·ÄÄ·Ä≠·ÄØ ·Äñ·Äº·Ää·Ä∑·Ä∫·Äï·Ä´', 'error');
                return;
            }
            
            const fullPhone = country + phone;

            try {
                // Check user in database
                const { data: userData, error: userError } = await supabase
                    .from('users')
                    .select('*')
                    .eq('phone', fullPhone)
                    .eq('password', password)
                    .single();

                if (userError || !userData) {
                    showNotification('Invalid phone number or password | ·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Ä´·Äê·Ä∫ ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ ·ÄÖ·ÄÄ·Ä¨·Ä∏·Äù·Äæ·ÄÄ·Ä∫ ·Äô·Äæ·Ä¨·Ä∏·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫', 'error');
                    return;
                }

                if (userData.status === 'banned') {
                    showNotification('Your account has been banned | ·Äû·ÄÑ·Ä∑·Ä∫·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·ÄÄ·Ä≠·ÄØ ·Äï·Ä≠·Äê·Ä∫·Äë·Ä¨·Ä∏·Äï·Ä´·Äû·Ää·Ä∫', 'error');
                    return;
                }

                // Sign in with Supabase auth
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: `${fullPhone.replace('+', '')}@pgopper.com`,
                    password: password,
                });

                if (error) throw error;

                currentUser = data.user;
                await loadUserData();
                showMainApp();
                showNotification('Login successful! | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äù·ÄÑ·Ä∫·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Äæ·ÄØ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫!', 'success');
                
                // Clear form
                document.getElementById('loginFormElement').reset();
            } catch (error) {
                console.error('Login error:', error);
                showNotification('Login failed: ' + error.message, 'error');
            }
        }

        async function handleLogout() {
            if (!supabase) return;
            
            const { error } = await supabase.auth.signOut();
            if (!error) {
                currentUser = null;
                newsProfile = null;
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('authScreen').classList.remove('hidden');
                showLoginForm();
                showNotification('Logged out successfully | ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äô·Äæ ·Äë·ÄΩ·ÄÄ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ', 'info');
            }
        }

        // Main App Functions
        async function showMainApp() {
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            await Promise.all([
                loadFiles(),
                loadNews(),
                loadAboutContent(),
                loadPurchaseHistory(),
                loadChatList()
            ]);
            
            // Start real-time subscriptions
            setupRealtimeSubscriptions();
        }

        async function loadUserData() {
            if (!currentUser || !supabase) return;
            
            try {
                const { data: userData } = await supabase
                    .from('users')
                    .select('*')
                    .eq('id', currentUser.id)
                    .single();

                if (userData) {
                    document.getElementById('profileName').textContent = userData.name || 'User';
                    document.getElementById('profilePhone').textContent = userData.phone || '';
                    document.getElementById('profileCountry').textContent = getCountryName(userData.country) || 'Unknown';
                }

                // Load news profile
                const { data: newsProfileData } = await supabase
                    .from('news_profiles')
                    .select('*')
                    .eq('user_id', currentUser.id)
                    .single();

                if (newsProfileData) {
                    newsProfile = newsProfileData;
                }

                // Update stats
                await updateUserStats();
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        async function updateUserStats() {
            if (!currentUser || !supabase) return;
            
            try {
                // Load purchase count
                const { data: purchases } = await supabase
                    .from('purchases')
                    .select('*')
                    .eq('user_id', currentUser.id)
                    .eq('status', 'approved');

                document.getElementById('purchaseCount').textContent = purchases?.length || 0;

                // Load news count
                const { data: userNews } = await supabase
                    .from('news')
                    .select('*')
                    .eq('user_id', currentUser.id);

                document.getElementById('newsCount').textContent = userNews?.length || 0;

                // Load chat count
                const { data: chats } = await supabase
                    .from('chats')
                    .select('*')
                    .or(`user1_id.eq.${currentUser.id},user2_id.eq.${currentUser.id}`);

                document.getElementById('chatCount').textContent = chats?.length || 0;
            } catch (error) {
                console.error('Error updating stats:', error);
            }
        }

        function getCountryName(code) {
            const countries = {
                '+95': 'Myanmar',
                '+86': 'China',
                '+65': 'Singapore',
                '+66': 'Thailand'
            };
            return countries[code] || 'Unknown';
        }

        function switchPage(page) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            
            // Show selected page
            document.getElementById(page + 'Page').classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelector(`[data-page="${page}"]`).classList.add('active');
            
            currentPage = page;

            // Load page-specific content
            if (page === 'chat') {
                loadChatList();
            } else if (page === 'news') {
                loadNews();
            } else if (page === 'support') {
                loadSupportMessages();
            } else if (page === 'mi') {
                loadPurchaseHistory();
            }
        }

        // Files Functions
        async function loadFiles() {
            if (!supabase) return;
            
            try {
                const { data: filesData } = await supabase
                    .from('files')
                    .select('*')
                    .order('created_at', { ascending: false });

                files = filesData || [];
                displayFiles();
            } catch (error) {
                console.error('Error loading files:', error);
                showNotification('Error loading files', 'error');
            }
        }

        function displayFiles() {
            const fileGrid = document.getElementById('fileGrid');
            const emptyState = document.getElementById('emptyState');

            if (files.length === 0) {
                fileGrid.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            fileGrid.innerHTML = '';

            files.forEach(file => {
                const fileElement = document.createElement('div');
                fileElement.className = 'file-card card-hover';
                
                const iconClass = file.file_type === 'apk' ? 'fab fa-android' : 'fas fa-file-alt';
                const typeLabel = file.file_type === 'apk' ? 'APK' : 'FILE';
                
                fileElement.innerHTML = `
                    <div class="text-center mb-4">
                        <div class="feature-icon mx-auto mb-3">
                            <i class="${iconClass} text-2xl text-blue-600"></i>
                        </div>
                        <span class="inline-block px-3 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded-full mb-2">${typeLabel}</span>
                    </div>
                    <h3 class="font-bold text-gray-800 mb-2 text-center text-sm">${file.name}</h3>
                    <p class="text-gray-600 text-xs mb-3 text-center line-clamp-2">${file.description || 'No description'}</p>
                    <div class="text-center mb-4">
                        <span class="text-2xl font-bold text-green-600">$${file.price}</span>
                    </div>
                    <button onclick="purchaseFile('${file.id}')" class="w-full btn-primary text-white py-3 rounded-xl font-semibold text-sm">
                        <i class="fas fa-shopping-cart mr-2"></i>Buy Now
                    </button>
                `;
                
                fileGrid.appendChild(fileElement);
            });
        }

        async function purchaseFile(fileId) {
            if (!currentUser) {
                showNotification('Please login first', 'error');
                return;
            }

            try {
                const file = files.find(f => f.id === fileId);
                if (!file) return;

                // Check if already purchased
                const { data: existingPurchase } = await supabase
                    .from('purchases')
                    .select('*')
                    .eq('user_id', currentUser.id)
                    .eq('file_id', fileId)
                    .eq('status', 'approved')
                    .single();

                if (existingPurchase) {
                    // Allow download
                    downloadFile(file);
                    return;
                }

                // Show purchase modal
                showPurchaseModal(file);
            } catch (error) {
                console.error('Purchase error:', error);
                showNotification('Error processing purchase', 'error');
            }
        }

        function showPurchaseModal(file) {
            const modal = document.getElementById('purchaseModal');
            const content = document.getElementById('purchaseContent');
            
            content.innerHTML = `
                <div class="text-center mb-6">
                    <div class="feature-icon mx-auto mb-4">
                        <i class="fas fa-${file.file_type === 'apk' ? 'mobile-alt' : 'file-alt'} text-2xl text-white"></i>
                    </div>
                    <h4 class="text-white text-xl font-bold mb-2">${file.name}</h4>
                    <p class="text-white opacity-80 mb-4">${file.description || 'No description'}</p>
                    <div class="text-center">
                        <span class="text-3xl font-bold text-green-400">$${file.price}</span>
                    </div>
                </div>
                
                <div class="space-y-4" id="paymentMethods">
                    <h5 class="text-white font-semibold mb-3">Choose Payment Method:</h5>
                    <!-- Payment methods will be loaded here -->
                </div>
            `;

            loadPaymentMethods(file.id);
            modal.classList.remove('hidden');
        }

        async function loadPaymentMethods(fileId) {
            if (!supabase) return;
            
            try {
                const { data: methods } = await supabase
                    .from('payment_methods')
                    .select('*')
                    .eq('active', true);

                const container = document.getElementById('paymentMethods');
                if (!methods || methods.length === 0) {
                    container.innerHTML += '<p class="text-white opacity-70">No payment methods available</p>';
                    return;
                }

                methods.forEach(method => {
                    const methodElement = document.createElement('div');
                    methodElement.className = 'payment-option';
                    methodElement.onclick = () => selectPaymentMethod(method, fileId);
                    
                    methodElement.innerHTML = `
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                ${method.qr_code ? `<img src="${method.qr_code}" alt="QR" class="w-10 h-10 rounded">` : '<i class="fas fa-credit-card text-2xl text-white"></i>'}
                                <div>
                                    <h6 class="text-white font-semibold">${method.name}</h6>
                                    <p class="text-white opacity-70 text-sm">${method.phone || method.account_info || ''}</p>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-white opacity-50"></i>
                        </div>
                    `;
                    
                    container.appendChild(methodElement);
                });
            } catch (error) {
                console.error('Error loading payment methods:', error);
            }
        }

        function selectPaymentMethod(method, fileId) {
            // Remove previous selections
            document.querySelectorAll('.payment-option').forEach(el => el.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            // Update confirm button
            const confirmBtn = document.getElementById('confirmPurchase');
            confirmBtn.onclick = () => proceedToPayment(method, fileId);
        }

        function proceedToPayment(method, fileId) {
            closePurchaseModal();
            showPaymentProofModal(method, fileId);
        }

        function showPaymentProofModal(method, fileId) {
            const modal = document.getElementById('paymentProofModal');
            const form = document.getElementById('paymentProofForm');
            
            form.onsubmit = (e) => handlePaymentProofSubmit(e, method, fileId);
            modal.classList.remove('hidden');
        }

        async function handlePaymentProofSubmit(e, method, fileId) {
            e.preventDefault();
            
            if (!currentUser || !supabase) return;
            
            const fileInput = document.getElementById('paymentProofFile');
            const transactionId = document.getElementById('transactionId').value;
            
            if (!fileInput.files[0]) {
                showNotification('Please select payment proof image', 'error');
                return;
            }

            try {
                // Upload payment proof
                const file = fileInput.files[0];
                const fileName = `payment_${currentUser.id}_${Date.now()}.${file.name.split('.').pop()}`;
                
                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from('payment_proofs')
                    .upload(fileName, file);

                if (uploadError) throw uploadError;

                // Create purchase record
                const { error: purchaseError } = await supabase
                    .from('purchases')
                    .insert([
                        {
                            user_id: currentUser.id,
                            file_id: fileId,
                            payment_method_id: method.id,
                            amount: files.find(f => f.id === fileId).price,
                            payment_proof: uploadData.path,
                            transaction_id: transactionId,
                            status: 'pending',
                            created_at: new Date().toISOString()
                        }
                    ]);

                if (purchaseError) throw purchaseError;

                closePaymentProofModal();
                showNotification('Purchase request submitted! Please wait for admin approval. | ·Äù·Äö·Ä∫·Äö·Ä∞·Äô·Äæ·ÄØ·Äê·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÜ·Ä≠·ÄØ·ÄÅ·Äª·ÄÄ·Ä∫ ·Äï·Ä±·Ä∏·Äï·Ä≠·ÄØ·Ä∑·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ! ·Ä°·ÄÄ·Ä∫·Äí·Äô·ÄÑ·Ä∫ ·Ä°·Äê·Ää·Ä∫·Äï·Äº·ÄØ·ÄÅ·Äª·ÄÄ·Ä∫ ·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äï·Ä´·Åã', 'success');
                
                // Reset form
                document.getElementById('paymentProofForm').reset();
            } catch (error) {
                console.error('Payment proof error:', error);
                showNotification('Error submitting payment proof', 'error');
            }
        }

        async function downloadFile(file) {
            if (!supabase) return;
            
            try {
                const { data } = await supabase.storage
                    .from('files')
                    .createSignedUrl(file.file_path, 3600);

                if (data.signedUrl) {
                    const link = document.createElement('a');
                    link.href = data.signedUrl;
                    link.download = file.name;
                    link.click();
                    
                    showNotification('Download started! | ·Äí·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·Äú·ÄØ·Äí·Ä∫ ·ÄÖ·Äê·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!', 'success');
                }
            } catch (error) {
                console.error('Download error:', error);
                showNotification('Error downloading file', 'error');
            }
        }

        // News Functions
        async function loadNews() {
            if (!supabase) return;
            
            try {
                const { data: newsData } = await supabase
                    .from('news')
                    .select(`
                        *,
                        news_profiles (
                            username,
                            display_name,
                            profile_picture
                        ),
                        users (
                            name
                        )
                    `)
                    .order('created_at', { ascending: false });

                news = newsData || [];
                displayNews();
            } catch (error) {
                console.error('Error loading news:', error);
            }
        }

        function displayNews() {
            const newsFeed = document.getElementById('newsFeed');
            const emptyState = document.getElementById('emptyNewsState');

            if (news.length === 0) {
                newsFeed.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            newsFeed.innerHTML = '';

            news.forEach(newsItem => {
                const newsElement = document.createElement('div');
                newsElement.className = 'news-card glass-effect p-6';
                
                const authorName = newsItem.news_profiles?.display_name || newsItem.users?.name || 'Unknown';
                const authorUsername = newsItem.news_profiles?.username || '';
                const authorAvatar = newsItem.news_profiles?.profile_picture || '';
                
                newsElement.innerHTML = `
                    <div class="flex items-center space-x-4 mb-4">
                        <div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center overflow-hidden">
                            ${authorAvatar ? `<img src="${authorAvatar}" alt="${authorName}" class="w-full h-full object-cover">` : `<i class="fas fa-user text-white"></i>`}
                        </div>
                        <div>
                            <h4 class="text-white font-semibold">${authorName}</h4>
                            <p class="text-white opacity-70 text-sm">@${authorUsername} ‚Ä¢ ${formatDate(newsItem.created_at)}</p>
                        </div>
                    </div>
                    
                    <h3 class="text-white text-lg font-bold mb-3">${newsItem.title}</h3>
                    <p class="text-white opacity-90 mb-4 leading-relaxed">${newsItem.content}</p>
                    
                    ${newsItem.media_files ? displayNewsMedia(newsItem.media_files) : ''}
                    
                    <div class="flex items-center justify-between pt-4 border-t border-white border-opacity-20">
                        <button onclick="likeNews('${newsItem.id}')" class="flex items-center space-x-2 text-white opacity-70 hover:opacity-100 transition-opacity">
                            <i class="fas fa-heart"></i>
                            <span>Like</span>
                        </button>
                        <button onclick="shareNews('${newsItem.id}')" class="flex items-center space-x-2 text-white opacity-70 hover:opacity-100 transition-opacity">
                            <i class="fas fa-share"></i>
                            <span>Share</span>
                        </button>
                    </div>
                `;
                
                newsFeed.appendChild(newsElement);
            });
        }

        function displayNewsMedia(mediaFiles) {
            if (!mediaFiles || mediaFiles.length === 0) return '';
            
            let mediaHtml = '<div class="grid grid-cols-2 gap-3 mb-4">';
            
            mediaFiles.forEach((file, index) => {
                if (index >= 4) return; // Limit to 4 media files
                
                const fileExtension = file.split('.').pop().toLowerCase();
                
                if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                    mediaHtml += `<img src="${file}" alt="News media" class="rounded-lg w-full h-32 object-cover">`;
                } else if (['mp4', 'webm', 'ogg'].includes(fileExtension)) {
                    mediaHtml += `<video controls class="rounded-lg w-full h-32 object-cover">
                        <source src="${file}" type="video/${fileExtension}">
                    </video>`;
                } else if (['mp3', 'wav', 'ogg'].includes(fileExtension)) {
                    mediaHtml += `<audio controls class="w-full">
                        <source src="${file}" type="audio/${fileExtension}">
                    </audio>`;
                }
            });
            
            mediaHtml += '</div>';
            return mediaHtml;
        }

        function showCreateNewsModal() {
            if (!newsProfile) {
                showNotification('Please create a news profile first | ·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äû·Äê·ÄÑ·Ä∫·Ä∏·Äï·Äõ·Ä≠·ÄØ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫ ·Äñ·Äî·Ä∫·Äê·ÄÆ·Ä∏·Äï·Ä´', 'error');
                return;
            }
            
            document.getElementById('createNewsModal').classList.remove('hidden');
        }

        function closeCreateNewsModal() {
            document.getElementById('createNewsModal').classList.add('hidden');
            document.getElementById('createNewsForm').reset();
        }

        async function handleCreateNews(e) {
            e.preventDefault();
            
            if (!currentUser || !newsProfile || !supabase) return;
            
            const title = document.getElementById('newsTitle').value.trim();
            const content = document.getElementById('newsContent').value.trim();
            const tagUsers = document.getElementById('tagUsers').value.trim();
            const mediaFiles = document.getElementById('newsMedia').files;
            
            if (!title || !content) {
                showNotification('Please fill all required fields', 'error');
                return;
            }

            try {
                let uploadedFiles = [];
                
                // Upload media files
                if (mediaFiles.length > 0) {
                    for (let file of mediaFiles) {
                        const fileName = `news_${currentUser.id}_${Date.now()}_${file.name}`;
                        const { data: uploadData, error: uploadError } = await supabase.storage
                            .from('news_media')
                            .upload(fileName, file);

                        if (uploadError) throw uploadError;
                        
                        const { data } = await supabase.storage
                            .from('news_media')
                            .getPublicUrl(uploadData.path);
                        
                        uploadedFiles.push(data.publicUrl);
                    }
                }

                // Create news post
                const { error: newsError } = await supabase
                    .from('news')
                    .insert([
                        {
                            user_id: currentUser.id,
                            news_profile_id: newsProfile.id,
                            title: title,
                            content: content,
                            media_files: uploadedFiles,
                            tagged_users: tagUsers ? tagUsers.split(' ').filter(tag => tag.startsWith('@')).map(tag => tag.slice(1)) : [],
                            created_at: new Date().toISOString()
                        }
                    ]);

                if (newsError) throw newsError;

                closeCreateNewsModal();
                showNotification('News posted successfully! | ·Äû·Äê·ÄÑ·Ä∫·Ä∏ ·Äê·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!', 'success');
                await loadNews();
                await updateUserStats();
            } catch (error) {
                console.error('Create news error:', error);
                showNotification('Error creating news post', 'error');
            }
        }

        function showNewsProfileModal() {
            document.getElementById('newsProfileModal').classList.remove('hidden');
        }

        function closeNewsProfileModal() {
            document.getElementById('newsProfileModal').classList.add('hidden');
            document.getElementById('newsProfileForm').reset();
        }

        async function handleCreateNewsProfile(e) {
            e.preventDefault();
            
            if (!currentUser || !supabase) return;
            
            const username = document.getElementById('newsUsername').value.trim();
            const displayName = document.getElementById('newsDisplayName').value.trim();
            const profilePicture = document.getElementById('newsProfilePicture').files[0];
            
            if (!username || !displayName) {
                showNotification('Please fill all required fields', 'error');
                return;
            }

            try {
                // Check if username already exists
                const { data: existingProfile } = await supabase
                    .from('news_profiles')
                    .select('*')
                    .eq('username', username)
                    .single();

                if (existingProfile) {
                    showNotification('Username already taken | ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äû·Ä∞·Ä°·Äô·Ää·Ä∫ ·Äõ·Äæ·Ä≠·Äï·Äº·ÄÆ·Ä∏·Äû·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫', 'error');
                    return;
                }

                let profilePictureUrl = null;
                
                // Upload profile picture
                if (profilePicture) {
                    const fileName = `profile_${currentUser.id}_${Date.now()}.${profilePicture.name.split('.').pop()}`;
                    const { data: uploadData, error: uploadError } = await supabase.storage
                        .from('profile_pictures')
                        .upload(fileName, profilePicture);

                    if (uploadError) throw uploadError;
                    
                    const { data } = await supabase.storage
                        .from('profile_pictures')
                        .getPublicUrl(uploadData.path);
                    
                    profilePictureUrl = data.publicUrl;
                }

                // Create news profile
                const { data: profileData, error: profileError } = await supabase
                    .from('news_profiles')
                    .insert([
                        {
                            user_id: currentUser.id,
                            username: username,
                            display_name: displayName,
                            profile_picture: profilePictureUrl,
                            created_at: new Date().toISOString()
                        }
                    ])
                    .select()
                    .single();

                if (profileError) throw profileError;

                newsProfile = profileData;
                closeNewsProfileModal();
                showNotification('News profile created successfully! | ·Äû·Äê·ÄÑ·Ä∫·Ä∏·Äï·Äõ·Ä≠·ÄØ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫ ·Äñ·Äî·Ä∫·Äê·ÄÆ·Ä∏·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!', 'success');
            } catch (error) {
                console.error('Create news profile error:', error);
                showNotification('Error creating news profile', 'error');
            }
        }

        // Chat Functions
        async function loadChatList() {
            if (!currentUser || !supabase) return;
            
            try {
                const { data: chats } = await supabase
                    .from('chats')
                    .select(`
                        *,
                        user1:users!chats_user1_id_fkey (
                            id,
                            name,
                            phone
                        ),
                        user2:users!chats_user2_id_fkey (
                            id,
                            name,
                            phone
                        )
                    `)
                    .or(`user1_id.eq.${currentUser.id},user2_id.eq.${currentUser.id}`)
                    .order('last_message_at', { ascending: false });

                chatList = chats || [];
                displayChatList();
            } catch (error) {
                console.error('Error loading chat list:', error);
            }
        }

        function displayChatList() {
            const chatListElement = document.getElementById('chatList');
            const emptyState = document.getElementById('emptyChatState');

            if (chatList.length === 0) {
                chatListElement.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            chatListElement.innerHTML = '';

            chatList.forEach(chat => {
                const otherUser = chat.user1_id === currentUser.id ? chat.user2 : chat.user1;
                
                const chatElement = document.createElement('div');
                chatElement.className = 'glass-effect rounded-xl p-4 cursor-pointer hover:bg-white hover:bg-opacity-10 transition-all card-hover';
                chatElement.onclick = () => openChat(otherUser);
                
                chatElement.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center">
                            <i class="fas fa-user text-white"></i>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-white font-semibold">${otherUser.name}</h4>
                            <p class="text-white opacity-70 text-sm">${chat.last_message || 'Start conversation'}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-white opacity-60 text-xs">${chat.last_message_at ? formatDate(chat.last_message_at) : ''}</p>
                        </div>
                    </div>
                `;
                
                chatListElement.appendChild(chatElement);
            });
        }

        async function searchUsers() {
            const query = document.getElementById('userSearchInput').value.trim();
            if (!query || !supabase) return;

            try {
                const { data: users } = await supabase
                    .from('news_profiles')
                    .select(`
                        *,
                        users (
                            id,
                            name,
                            phone
                        )
                    `)
                    .ilike('username', `%${query}%`)
                    .limit(10);

                displaySearchResults(users || []);
            } catch (error) {
                console.error('Search error:', error);
            }
        }

        function displaySearchResults(users) {
            const chatListElement = document.getElementById('chatList');
            
            if (users.length === 0) {
                chatListElement.innerHTML = '<p class="text-white opacity-70 text-center py-8">No users found</p>';
                return;
            }

            chatListElement.innerHTML = '';
            
            users.forEach(user => {
                const userElement = document.createElement('div');
                userElement.className = 'glass-effect rounded-xl p-4 cursor-pointer hover:bg-white hover:bg-opacity-10 transition-all card-hover';
                userElement.onclick = () => startChat(user.users);
                
                userElement.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 rounded-full overflow-hidden">
                            ${user.profile_picture ? `<img src="${user.profile_picture}" alt="${user.display_name}" class="w-full h-full object-cover">` : '<div class="w-full h-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center"><i class="fas fa-user text-white"></i></div>'}
                        </div>
                        <div class="flex-1">
                            <h4 class="text-white font-semibold">${user.display_name}</h4>
                            <p class="text-white opacity-70 text-sm">@${user.username}</p>
                        </div>
                        <i class="fas fa-comment text-white opacity-50"></i>
                    </div>
                `;
                
                chatListElement.appendChild(userElement);
            });
        }

        async function startChat(user) {
            if (!currentUser || !supabase) return;
            
            try {
                // Check if chat already exists
                let { data: existingChat } = await supabase
                    .from('chats')
                    .select('*')
                    .or(`and(user1_id.eq.${currentUser.id},user2_id.eq.${user.id}),and(user1_id.eq.${user.id},user2_id.eq.${currentUser.id})`)
                    .single();

                if (!existingChat) {
                    // Create new chat
                    const { data: newChat, error } = await supabase
                        .from('chats')
                        .insert([
                            {
                                user1_id: currentUser.id,
                                user2_id: user.id,
                                created_at: new Date().toISOString(),
                                last_message_at: new Date().toISOString()
                            }
                        ])
                        .select()
                        .single();

                    if (error) throw error;
                    existingChat = newChat;
                }

                openChat(user, existingChat.id);
            } catch (error) {
                console.error('Start chat error:', error);
                showNotification('Error starting chat', 'error');
            }
        }

        function openChat(user, chatId = null) {
            currentChatUser = user;
            
            // Update chat modal
            document.getElementById('chatUserName').textContent = user.name;
            document.getElementById('chatUserStatus').textContent = 'Online';
            
            // Load chat messages
            loadChatMessages(chatId);
            
            // Show chat modal
            document.getElementById('chatModal').classList.remove('hidden');
        }

        async function loadChatMessages(chatId) {
            if (!chatId || !supabase) return;
            
            try {
                const { data: messages } = await supabase
                    .from('chat_messages')
                    .select('*')
                    .eq('chat_id', chatId)
                    .order('created_at', { ascending: true });

                displayChatMessages(messages || []);
            } catch (error) {
                console.error('Error loading chat messages:', error);
            }
        }

        function displayChatMessages(messages) {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '';

            if (messages.length === 0) {
                messagesContainer.innerHTML = '<p class="text-white opacity-70 text-center py-8">Start your conversation!</p>';
                return;
            }

            messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = `chat-bubble p-3 ${message.sender_id === currentUser.id ? 'sent' : 'received'}`;
                
                messageElement.innerHTML = `
                    <p class="mb-1">${message.content}</p>
                    <p class="text-xs opacity-70">${formatTime(message.created_at)}</p>
                `;
                
                messagesContainer.appendChild(messageElement);
            });

            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        async function sendChatMessage() {
            const input = document.getElementById('chatMessageInput');
            const message = input.value.trim();
            
            if (!message || !currentChatUser || !currentUser || !supabase) return;

            try {
                // Find chat ID
                const { data: chat } = await supabase
                    .from('chats')
                    .select('*')
                    .or(`and(user1_id.eq.${currentUser.id},user2_id.eq.${currentChatUser.id}),and(user1_id.eq.${currentChatUser.id},user2_id.eq.${currentUser.id})`)
                    .single();

                if (!chat) return;

                // Send message
                const { error } = await supabase
                    .from('chat_messages')
                    .insert([
                        {
                            chat_id: chat.id,
                            sender_id: currentUser.id,
                            content: message,
                            created_at: new Date().toISOString()
                        }
                    ]);

                if (error) throw error;

                // Update chat last message
                await supabase
                    .from('chats')
                    .update({
                        last_message: message,
                        last_message_at: new Date().toISOString()
                    })
                    .eq('id', chat.id);

                input.value = '';
                loadChatMessages(chat.id);
            } catch (error) {
                console.error('Send message error:', error);
                showNotification('Error sending message', 'error');
            }
        }

        function closeChatModal() {
            document.getElementById('chatModal').classList.add('hidden');
            currentChatUser = null;
        }

        // Support Functions
        async function loadSupportMessages() {
            if (!currentUser || !supabase) return;
            
            try {
                const { data: messages } = await supabase
                    .from('support_messages')
                    .select('*')
                    .eq('user_id', currentUser.id)
                    .order('created_at', { ascending: true });

                displaySupportMessages(messages || []);
            } catch (error) {
                console.error('Error loading support messages:', error);
            }
        }

        function displaySupportMessages(messages) {
            const messagesContainer = document.getElementById('supportMessages');
            
            // Keep welcome message and add new messages
            const welcomeMessage = messagesContainer.querySelector('.chat-bubble.received');
            messagesContainer.innerHTML = '';
            
            if (welcomeMessage) {
                messagesContainer.appendChild(welcomeMessage);
            }

            messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = `chat-bubble p-4 ${message.is_admin ? 'received' : 'sent'}`;
                
                let content = `<p class="mb-2">${message.content}</p>`;
                
                if (message.file_url) {
                    const fileExtension = message.file_url.split('.').pop().toLowerCase();
                    if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                        content += `<img src="${message.file_url}" alt="Attachment" class="max-w-full h-32 object-cover rounded-lg mb-2">`;
                    } else if (['mp3', 'wav', 'ogg'].includes(fileExtension)) {
                        content += `<audio controls class="mb-2"><source src="${message.file_url}"></audio>`;
                    } else {
                        content += `<a href="${message.file_url}" target="_blank" class="text-blue-300 underline mb-2 block">View Attachment</a>`;
                    }
                }
                
                content += `<p class="text-xs opacity-70">${formatTime(message.created_at)}</p>`;
                
                messageElement.innerHTML = content;
                messagesContainer.appendChild(messageElement);
            });

            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        async function sendSupportMessage() {
            const input = document.getElementById('supportMessageInput');
            const message = input.value.trim();
            
            if (!message || !currentUser || !supabase) return;

            try {
                const { error } = await supabase
                    .from('support_messages')
                    .insert([
                        {
                            user_id: currentUser.id,
                            content: message,
                            is_admin: false,
                            created_at: new Date().toISOString()
                        }
                    ]);

                if (error) throw error;

                input.value = '';
                loadSupportMessages();
            } catch (error) {
                console.error('Send support message error:', error);
                showNotification('Error sending message', 'error');
            }
        }

        async function handleSupportFileUpload() {
            const fileInput = document.getElementById('supportFileInput');
            const file = fileInput.files[0];
            
            if (!file || !currentUser || !supabase) return;

            try {
                // Upload file
                const fileName = `support_${currentUser.id}_${Date.now()}.${file.name.split('.').pop()}`;
                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from('support_files')
                    .upload(fileName, file);

                if (uploadError) throw uploadError;

                const { data } = await supabase.storage
                    .from('support_files')
                    .getPublicUrl(uploadData.path);

                // Send message with file
                const { error } = await supabase
                    .from('support_messages')
                    .insert([
                        {
                            user_id: currentUser.id,
                            content: `Sent a file: ${file.name}`,
                            file_url: data.publicUrl,
                            is_admin: false,
                            created_at: new Date().toISOString()
                        }
                    ]);

                if (error) throw error;

                fileInput.value = '';
                loadSupportMessages();
                showNotification('File sent successfully', 'success');
            } catch (error) {
                console.error('File upload error:', error);
                showNotification('Error uploading file', 'error');
            }
        }

        // About Functions
        async function loadAboutContent() {
            if (!supabase) return;
            
            try {
                const { data: aboutItems } = await supabase
                    .from('about_items')
                    .select('*')
                    .order('created_at', { ascending: false });

                displayAboutContent(aboutItems || []);
            } catch (error) {
                console.error('Error loading about content:', error);
            }
        }

        function displayAboutContent(items) {
            const aboutContent = document.getElementById('aboutContent');
            const defaultAbout = document.getElementById('defaultAbout');

            if (items.length === 0) {
                aboutContent.innerHTML = '';
                defaultAbout.classList.remove('hidden');
                return;
            }

            defaultAbout.classList.add('hidden');
            aboutContent.innerHTML = '';

            items.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'glass-effect rounded-2xl p-6 card-hover';
                
                itemElement.innerHTML = `
                    <div class="flex items-center space-x-4 mb-4">
                        ${item.icon ? `<img src="${item.icon}" alt="${item.name}" class="w-12 h-12 rounded-full">` : '<i class="fas fa-link text-2xl text-white"></i>'}
                        <div>
                            <h3 class="text-white text-xl font-bold">${item.name}</h3>
                            ${item.link ? `<a href="${item.link}" target="_blank" class="text-blue-300 hover:text-blue-200 text-sm transition-colors">Visit Link</a>` : ''}
                        </div>
                    </div>
                    ${item.description ? `<p class="text-white opacity-90">${item.description}</p>` : ''}
                `;
                
                aboutContent.appendChild(itemElement);
            });
        }

        // Purchase History
        async function loadPurchaseHistory() {
            if (!currentUser || !supabase) return;
            
            try {
                const { data: purchases } = await supabase
                    .from('purchases')
                    .select(`
                        *,
                        files (
                            name,
                            file_type,
                            price,
                            file_path
                        )
                    `)
                    .eq('user_id', currentUser.id)
                    .order('created_at', { ascending: false });

                displayPurchaseHistory(purchases || []);
            } catch (error) {
                console.error('Error loading purchase history:', error);
            }
        }

        function displayPurchaseHistory(purchases) {
            const historyContainer = document.getElementById('purchaseHistory');
            historyContainer.innerHTML = '';

            if (purchases.length === 0) {
                historyContainer.innerHTML = '<p class="text-white opacity-70 text-center py-4">No purchases yet | ·Äù·Äö·Ä∫·Äö·Ä∞·Äô·Äæ·ÄØ ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´</p>';
                return;
            }

            purchases.forEach(purchase => {
                const purchaseElement = document.createElement('div');
                purchaseElement.className = 'bg-white bg-opacity-20 rounded-xl p-4 flex justify-between items-center';
                
                const statusColor = purchase.status === 'approved' ? 'text-green-400' : 
                                   purchase.status === 'rejected' ? 'text-red-400' : 'text-yellow-400';
                
                purchaseElement.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <div class="feature-icon">
                            <i class="fas fa-${purchase.files.file_type === 'apk' ? 'mobile-alt' : 'file-alt'} text-white"></i>
                        </div>
                        <div>
                            <h4 class="text-white font-semibold">${purchase.files.name}</h4>
                            <p class="text-white opacity-70 text-sm">$${purchase.files.price} ‚Ä¢ ${formatDate(purchase.created_at)}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="${statusColor} text-sm font-semibold capitalize">${purchase.status}</span>
                        ${purchase.status === 'approved' ? `<button onclick="downloadPurchasedFile('${purchase.files.file_path}', '${purchase.files.name}')" class="block mt-2 btn-primary text-white px-4 py-2 rounded-lg text-xs">Download</button>` : ''}
                    </div>
                `;
                
                historyContainer.appendChild(purchaseElement);
            });
        }

        async function downloadPurchasedFile(filePath, fileName) {
            if (!supabase) return;
            
            try {
                const { data } = await supabase.storage
                    .from('files')
                    .createSignedUrl(filePath, 3600);

                if (data.signedUrl) {
                    const link = document.createElement('a');
                    link.href = data.signedUrl;
                    link.download = fileName;
                    link.click();
                    
                    showNotification('Download started! | ·Äí·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·Äú·ÄØ·Äí·Ä∫ ·ÄÖ·Äê·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!', 'success');
                }
            } catch (error) {
                console.error('Download error:', error);
                showNotification('Error downloading file', 'error');
            }
        }

        // Real-time Subscriptions
        function setupRealtimeSubscriptions() {
            if (!supabase || !currentUser) return;

            // Subscribe to new files
            supabase
                .channel('files')
                .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'files' }, () => {
                    loadFiles();
                })
                .subscribe();

            // Subscribe to news updates
            supabase
                .channel('news')
                .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'news' }, () => {
                    loadNews();
                })
                .subscribe();

            // Subscribe to support messages
            supabase
                .channel('support_messages')
                .on('postgres_changes', { 
                    event: 'INSERT', 
                    schema: 'public', 
                    table: 'support_messages',
                    filter: `user_id=eq.${currentUser.id}`
                }, () => {
                    loadSupportMessages();
                    }
                })
                .subscribe();
               }
           });
      </script>
   </body>
   </html>
